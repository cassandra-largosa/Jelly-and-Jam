pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--jelly and jam
--by spaghetti time
--cartdata("jelly and jam")

--animation stuff
function add_sprite(name, anim)
    sprites[name] = {anim=anim, frame=1}
end

function get_sprite(name)
    local sprite = sprites[name]
    return sprite.anim[sprite.frame]
end

function inc_anim(sprite)
    sprite.frame = (sprite.frame%(#sprite.anim))+1
end

--animations {frame1, frame2...}
slime_a = {0,0,2,2,4,4,6,6,4,4,2,2}

sprites = {}
add_sprite("slime", slime_a)

--hitbox stuff
function make_hit(x1, y1, x2, y2)
    return {x1=x1, y1=y1, x2=x2, y2=y2}
end

function make_rect(hit, x, y)
    local x1 = hit.x1+x
    local y1 = hit.y1+y
    local x2 = hit.x2+x
    local y2 = hit.y2+y
    return make_hit(x1, y1, x2, y2)
end

function get_rect(object)
    local name = object.name
    --if n == "fire"
        --return make_rect(fire_h, object.x, object.y)
    --elseif ...
end

function collide(r1, r2)
    if r1.x2 < r2.x1 or r1.x1 > r2.x2 or r1.y2 < r2.y1 or r1.y1 > r2.y2 then
        return false
    end
    return true
end

--hitboxes (x1, y1, x2, y2)
slime_h = make_hit(4,2,11,7)

--constants
--...

--status stuff
score = 0
mode = "title" --title, menu, play, dead
title_time = 0
dead_time = 0
song = "main" --main, rainbow

--menu stuff
menu_items = {"easy", "medium", "hard"}
menu_cursor = 1
menu_choice = 0

--high score stuff
function get_hiscores()
    local scores = {}
    local start = (menu_choice-1)*5
    for i = start,start+4 do
        add(scores, dget(i))
    end
    return scores
end

function set_hiscores()
    function sort(list)
        --reverse bubble sort (shut up)
        for i = #list-1,1,-1 do
            for j = 1,i do
                if list[j] < list[j+1] then
                    local temp = list[j+1]
                    list[j+1] = list[j]
                    list[j] = temp
                end
            end
        end
    end
    
    local scores = get_hiscores()
    add(scores, flr(score))
    sort(scores)
    
    local start = (menu_choice-1)*5
    for i = 1,5 do
        dset(start+i-1, scores[i])
    end
end

--spawning objects
function spawn(name)
    
end

function _draw()
    cls()
end

function _update()
    --animate sprites and bg
    for key,sprite in pairs(sprites) do
        inc_anim(sprite)
    end
end

__gfx__
000000000000680000aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000060680aaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000686060aaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000666660aa0aa0aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000606060aaaa999a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000666660aaaa9aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000066646660aaaa9a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000666466600aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001010100000001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001000101000001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001000001000100010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000010000010001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100041805018050180301803018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000
000100081885018850188501885018750187501875018750188001880018800188001870018700187001870018800188001880018800187001870018700187001880018800188001880018700187001870018700
00010410187511875118751187511a7511a7511c7511c7511d7511d7511c7511c7511a7511a75118751187540020100200162000020015a000000014a0013a0013a0000000000000000000000000000000000000
01010008183501835018350183500c3500c3500c3500c350183001830018300183001830018300183001830018300183001830018300183001830018300183001830018300183001830018300183001830018300
000100001855018550185501855029550295501a550235501f5501d550295501f5500d550155502c5501850018500185001850018500185001850018500181001810018100181001810018100181000000000000
000100200e5501355015550185501d5501f550225502355025550265502755028550285502855028550275502655024550225501f5501c550135500e550275502a5502d5502d5502b550265501f5501155007550
010100021805018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800018000180001800500000
0101060a2475123751217511f7511d7511c7511a75118751177511875110f000ef000cf0009f0008f0006f0005f0003f0002f0001f0011b001fd0011b001fd0022c0023c001ed0012d001dd001dd001dd0021e00
0110000018f5018f5018f5023f5023f5021f501af5021f501cf501ff501ff501ff501af501df501df501df5018f501ff501af501ff501cf5021f5021f5021f501ff5023f501cf5023f501af501ff5018f5018f50
011800100c433004030c633004030c433004030c6330c6030c433004030c4330c6030c4330c6330c4330c4030c4030c4030c6030c4030c6030c4030c4030c4030c4030c603004030c4030c6030c4030c40300000
011800002f73000000000002d7302b73000000267300000024730000002673000000237302373023730237302f73000000000002d7302b730000002d730000002f7300000030730000002d7302d7302d7302d730
011800002f73000000000002d7302b730000002673000000247300000026730000002a730000002d730000002b7302b730247002a7002a730000002b730000002a730000002b7302b7302b730000002f70000000
011800002f73000000000003073032730000003273000000347300000032730000002b7302b7302b7302a7052f73000000000002b7302d730000002f73000000327300000030730000002f7302f7302f73000000
011800002f7300000000000307303273000000327300000034730000003473032730000002d7302d730000002f7302f730000002d7302b730000002d7300000030730000002f7302b730000002a7302b73000000
000c00000400004000040000400006000060000600006000070000700007000070000200002000020000200004000040000400004000060000600006000060000700007000070000700000000000000000000000
0109000024b3024b3024b3029b3029b3029b302db302db302db3024b3024b302bb302bb302fb302fb302fb3030b3030b3030b3030b3030b3030b3030b0030b0030b0030b0000b0000b0000c000ec0012c0000c00
000c0000170501d0501e0501a050130501205014050180501c0501b050160500f0500b0500e0500c0500805003050010500100001000010300103001030010300100001000010000100001000010000000000000
01010000261501c15017150101500b1500715004150011500b100081000710004100021000110023a000000024e0024e000000024e0022e0021e00000001be0018e0013e000ee0005e0001e00000000000000000
0001000018450114500d450084500645003450024500265001650016000140001400014000e3000d3000c3000b3000b3000a3000a3000a3000a3000930009300093000a3000a3000a3000b300000000000000000
0101000020f5227f522df5231f5236f5221f5227f522bf522df521cf5234f5222f5229f5231f5236f5233f5201f523df5222f0221f021ff021cf021af0218f0216f0215c001370011700101000e1000d0000c000
010100001185030850308503085030850308503085000800008000080000800008003b850398503b850008003c8503c8503c8503c8503c8503c8503c850008000080000800008000080000800008000080000800
000100003e7503e750000003e7503e750000003d750000000000037750377500000037750377503775000000000003c7503c75000000000003c7503b75000000000003a7500000000000000003b7503975000000
000300001e0502305027050290502e050310503c0503d050240500e050220502b0503b0503f0501f05018050090500f0501905021050330503d0503f0502605016050220502e050390503d0500f0002200036000
0001000002e5004e5007e5007e5006e5005e5003e5003e5004e5006e5007e5008e5008e5006e5005e5004e5002e5001e5001e5002e5002e5022e0024e0001e0004e0007e000ee000be000ee0010e000ce0015e00
000500001365513655136551365513655136551365513655136551365513655136551365513655136551365513655136551365513655136551365513655136451364513645136351363513625136251362513615
00010000323502e3502a35027350253502235021350223502435025350273502635024350213501e3501a350173501535014350123501235015350193501c3501d3501e3501e3501d3501b3501a3501735014350
0001000036550335502e5502e550195501b5501e5501f550225501e55016550145502b5502e5503455034550325502d5502b55025550215501f55035550315502f55024550275502b55030550355503a5503d550
0002000014f5038f5038f5016f5037f501ef5037f5037f501af5039f5027f5037f5037f502ff5038f5020f5030f5025f5027f503af502af503bf503bf502ef5037f502ef5034f5025f5038f501ef501bf503df50
00010000182501c250292502e250302001b2501e25032200332502c2503925039250372501d20020250242502c2502c25022200222002420025200262002720025200292002b2002b2002d2002d2002f20032200
0004000034b5039a5034a502da5026a5024a502ea5037a503ea503fa5031b5036a502fa5028a5022a501ca5000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
01 090a4e44
00 090b4f44
00 090c4e44
00 090d4344
02 094e0e44

